const a23_0x1534d5=a23_0x37ac;(function(_0x4a9d89,_0x66977c){const _0x49ed91=a23_0x37ac,_0x15ef19=_0x4a9d89();while(!![]){try{const _0x4f5588=-parseInt(_0x49ed91(0x1af))/0x1*(-parseInt(_0x49ed91(0x19c))/0x2)+parseInt(_0x49ed91(0x198))/0x3+parseInt(_0x49ed91(0x1b1))/0x4*(parseInt(_0x49ed91(0x1ad))/0x5)+-parseInt(_0x49ed91(0x1b8))/0x6+-parseInt(_0x49ed91(0x1c5))/0x7+-parseInt(_0x49ed91(0x1a1))/0x8*(parseInt(_0x49ed91(0x1c7))/0x9)+-parseInt(_0x49ed91(0x1c4))/0xa;if(_0x4f5588===_0x66977c)break;else _0x15ef19['push'](_0x15ef19['shift']());}catch(_0xd68ac4){_0x15ef19['push'](_0x15ef19['shift']());}}}(a23_0x2bad,0xe75e9));function a23_0x2bad(){const _0x1f103d=['error','rsync\x20--recursive\x20--exclude\x20\x27node_modules\x27\x20--exclude\x20\x27.git\x27\x20','pkg_extras','8BFXMyI','rm\x20-Rf\x20','pkg_dir','/shared/','info','_copyDir','scripts','holder_dir','removeBaseDistDir','dist_dir','pkg','Coping\x20bot\x20files...','5BBzuub','copySharedFiles','33TYatpz','changePkgForDist','535292uIsGjD','/apps/','dist','output_dir','../','opts','createWorkspacePkgJson','44532hZVDFJ','mkdir\x20-p\x20','holder_name','/dist','assets','bin','./src/assets/**','_copyDirIfExists','main','Alan\x20Bacelar\x20<alan@youfy.com.br>','child_process','removeTempFiles','2040710uvpCtZ','9601375tEewXK','./index.js','9095607jCAdsi','**/*.html','ISC','copySourceFiles','apps/*','bots','workspace_dir','shared','exports','getPackage','installDepedencies','cwd','base_dir','inherit','**/*.js','./src/index.js','4798809XjWNzq','bot_dir','/common/','mv\x20','109576JlGWnS','/apps'];a23_0x2bad=function(){return _0x1f103d;};return a23_0x2bad();}function a23_0x37ac(_0x20c9bc,_0x9333c5){const _0x2badea=a23_0x2bad();return a23_0x37ac=function(_0x37acba,_0x1f57b1){_0x37acba=_0x37acba-0x197;let _0x20bf0e=_0x2badea[_0x37acba];return _0x20bf0e;},a23_0x37ac(_0x20c9bc,_0x9333c5);}const log=require('./logger'),findWorkspaceRoot=require('find-yarn-workspace-root'),{execSync}=require(a23_0x1534d5(0x1c2)),{resolve,basename}=require('path'),{writeFileSync,existsSync}=require('fs');class BotDistributor{constructor(_0x65773d){const _0x3e0311=a23_0x1534d5;this['opts']={'base_dir':process[_0x3e0311(0x1d2)](),'output_dir':'/tmp/yfy_bot_workspace_dist',..._0x65773d},this[_0x3e0311(0x1a3)]=resolve(this['opts'][_0x3e0311(0x1d3)],'package.json'),this[_0x3e0311(0x1ab)]=this[_0x3e0311(0x1d0)](),this[_0x3e0311(0x1cd)]=findWorkspaceRoot(this[_0x3e0311(0x1b6)][_0x3e0311(0x1d3)]),this[_0x3e0311(0x1a8)]=resolve(this[_0x3e0311(0x1b6)][_0x3e0311(0x1d3)],_0x3e0311(0x1b5)),this['holder_name']=basename(this[_0x3e0311(0x1a8)]),this['bot_dir']=resolve(this['opts'][_0x3e0311(0x1b4)],basename(this[_0x3e0311(0x1ab)]['name'])),this[_0x3e0311(0x1aa)]=resolve(this[_0x3e0311(0x199)],_0x3e0311(0x1b3));}[a23_0x1534d5(0x1d0)](){const _0x4d3630=a23_0x1534d5;try{return require(this[_0x4d3630(0x1a3)]);}catch(_0x2d3fcc){return console[_0x4d3630(0x19e)]('Package.json\x20not\x20found.\x20It\x20should\x20be\x20in\x20the\x20root\x20of\x20the\x20project.'),{};}}[a23_0x1534d5(0x1a6)](_0x30fc5e,_0x47064b,{cwd:_0x36c299}={}){const _0x312b1c=a23_0x1534d5;execSync(_0x312b1c(0x19f)+_0x30fc5e+'\x20'+_0x47064b,{'stdio':_0x312b1c(0x1d4),'cwd':_0x36c299});}[a23_0x1534d5(0x1bf)](_0x332b38,_0x1e0ce5,_0x230d14){const _0xa1d862=a23_0x1534d5;existsSync(_0x332b38)&&this[_0xa1d862(0x1a6)](_0x332b38,_0x1e0ce5,_0x230d14);}[a23_0x1534d5(0x1c3)](){const _0x292e95=a23_0x1534d5,{output_dir:_0x49d5b9}=this[_0x292e95(0x1b6)];execSync(_0x292e95(0x1a2)+_0x49d5b9),execSync(_0x292e95(0x1a2)+this[_0x292e95(0x1aa)]);}[a23_0x1534d5(0x1ca)](){const _0x57482b=a23_0x1534d5;log['info'](_0x57482b(0x1ac)),execSync(_0x57482b(0x1b9)+this[_0x57482b(0x199)]);const {base_dir:_0x541fb5}=this[_0x57482b(0x1b6)];this[_0x57482b(0x1a6)]('*',this['bot_dir'],{'cwd':_0x541fb5});}[a23_0x1534d5(0x1ae)](){const _0x19a6ae=a23_0x1534d5;log[_0x19a6ae(0x1a5)]('Coping\x20shared\x20files...');const _0x532626=this[_0x19a6ae(0x1b6)][_0x19a6ae(0x1b4)];execSync('mkdir\x20-p\x20'+_0x532626+'/'+this[_0x19a6ae(0x1ba)]),execSync('mkdir\x20-p\x20'+_0x532626+_0x19a6ae(0x19d)),this['_copyDir'](this[_0x19a6ae(0x1cd)]+_0x19a6ae(0x1a4),_0x532626+'/shared/'),this[_0x19a6ae(0x1bf)](this[_0x19a6ae(0x1a8)]+_0x19a6ae(0x19a),_0x532626+'/'+this[_0x19a6ae(0x1ba)]+'/common/'),this[_0x19a6ae(0x1bf)](this[_0x19a6ae(0x1a8)]+_0x19a6ae(0x1b2),_0x532626+'/'+this[_0x19a6ae(0x1ba)]+_0x19a6ae(0x19d));const _0x1e61a8=this[_0x19a6ae(0x1ab)]['apps']||[];for(const _0x2d1f90 of _0x1e61a8){this['_copyDir'](this[_0x19a6ae(0x1cd)]+'/apps/'+_0x2d1f90+'/',_0x532626+_0x19a6ae(0x1b2)+_0x2d1f90+'/');}}[a23_0x1534d5(0x1d1)](){const _0x451007=a23_0x1534d5;log[_0x451007(0x1a5)]('Install\x20bot\x20dependecies...');const {output_dir:_0x3a6ba6}=this[_0x451007(0x1b6)];execSync('yarn\x20install',{'stdio':_0x451007(0x1d4),'cwd':_0x3a6ba6});}[a23_0x1534d5(0x1b0)](){const _0x27cd60=a23_0x1534d5,_0xcf069b=this[_0x27cd60(0x1ab)];_0xcf069b[_0x27cd60(0x1bd)]=_0xcf069b['bin']||_0x27cd60(0x1c6),_0xcf069b[_0x27cd60(0x1c0)]=_0xcf069b['main']||_0x27cd60(0x197);const _0x3c083d=_0xcf069b[_0x27cd60(0x1a0)]||{},_0x3f6ce5=Array['isArray'](_0x3c083d['assets'])?_0x3c083d['assets']:_0x3c083d[_0x27cd60(0x1bc)]?[_0x3c083d['assets']]:[];_0xcf069b[_0x27cd60(0x1ab)]={'scripts':[_0x27cd60(0x1d5),..._0x3c083d[_0x27cd60(0x1a7)]||[]],'assets':[_0x27cd60(0x1be),_0x27cd60(0x1c8),..._0x3f6ce5],'outputPath':'dist'},_0xcf069b['scripts']={..._0xcf069b['scripts'],'dist':'pkg\x20--public-packages\x20\x22*\x22\x20.\x20--public'},writeFileSync(resolve(this[_0x27cd60(0x199)],'package.json'),JSON['stringify'](_0xcf069b));}[a23_0x1534d5(0x1b3)](){const _0x2da8=a23_0x1534d5;this[_0x2da8(0x1c3)](),this[_0x2da8(0x1ca)](),this[_0x2da8(0x1ae)](),this[_0x2da8(0x1b7)](),this[_0x2da8(0x1b0)](),this[_0x2da8(0x1d1)](),execSync('yarn\x20dist',{'stdio':_0x2da8(0x1d4),'cwd':this['bot_dir']});}['moveToBaseDir'](){const _0x1aae08=a23_0x1534d5;execSync(_0x1aae08(0x19b)+this[_0x1aae08(0x1aa)]+'\x20'+this[_0x1aae08(0x1b6)][_0x1aae08(0x1d3)]+_0x1aae08(0x1bb));}[a23_0x1534d5(0x1a9)](){const _0x13c1be=a23_0x1534d5;execSync('rm\x20-Rf\x20'+this[_0x13c1be(0x1b6)][_0x13c1be(0x1d3)]+_0x13c1be(0x1bb));}[a23_0x1534d5(0x1b7)](){const _0xcd3a3=a23_0x1534d5,_0x41cfc5={'name':_0xcd3a3(0x1cc),'private':!![],'workspaces':{'packages':[basename(this[_0xcd3a3(0x199)]),_0xcd3a3(0x1ce),_0xcd3a3(0x1cb),this[_0xcd3a3(0x1ba)]+'/*']},'author':_0xcd3a3(0x1c1),'license':_0xcd3a3(0x1c9)};writeFileSync(resolve(this[_0xcd3a3(0x1b6)][_0xcd3a3(0x1b4)],'package.json'),JSON['stringify'](_0x41cfc5));}}module[a23_0x1534d5(0x1cf)]=BotDistributor;